[![Built with Devbox](https://www.jetify.com/img/devbox/shield_galaxy.svg)](https://www.jetify.com/devbox/docs/contributor-quickstart/)
[![FlakeHub](https://img.shields.io/badge/FlakeHub-nix--rebuild--wrapper-blue)](../../)
[![GitHub license](https://img.shields.io/github/license/aloshy-ai/nixcontainer?logo=github)](../../blob/main/LICENSE)
[![CI](https://github.com/aloshy-ai/nixcontainer/actions/workflows/ci.yml/badge.svg)](../../actions/workflows/ci.yml)

## Usage

```sh
ghcr.io/aloshy-ai/nixcontainer:latest
```

Add this to your `.devcontainer/devcontainer.json`:

```json
{
  "image": "ghcr.io/aloshy-ai/nixcontainer:latest",
  "workspaceMount": "source=${localWorkspaceFolder},target=/workspace,type=bind,consistency=cached",
  "workspaceFolder": "/workspace"
}
```

The container is configured with `/workspace` as the default working directory and mount point for your project files. This ensures:
- Your local files are mounted into the container at `/workspace`
- VS Code opens directly in your project directory
- All development tools work with the correct file paths

<!-- gen-readme start - generated by https://github.com/jetify-com/devbox/ -->
## Getting Started
This project uses [devbox](https://github.com/jetify-com/devbox) to manage its development environment.

Install devbox:
```sh
curl -fsSL https://get.jetpack.io/devbox | bash
```

Start the devbox shell:
```sh 
devbox shell
```

Run a script in the devbox environment:
```sh
devbox run <script>
```
## Scripts
Scripts are custom commands that can be run using this project's environment. This project has the following scripts:

* [build](#devbox-run-build)
* [load](#devbox-run-load)
* [push](#devbox-run-push)

## Shell Init Hook
The Shell Init Hook is a script that runs whenever the devbox environment is instantiated. It runs 
on `devbox shell` and on `devbox run`.
```sh
gh auth status &>/dev/null || gh auth login
export GITHUB_TOKEN=$(gh auth token)
export GITHUB_USERNAME=$(gh api user | jq -r .login)
echo "▄▀█ █░░ █▀█ █▀ █░█ █▄░█ ░ ▄▀█ █
█▀█ █▄▄ █▄█ ▄█ █▀█ █░▀█ ▄ █▀█ █"
devbox run --list
```

## Packages

* [alejandra@latest](https://www.nixhub.io/packages/alejandra)
* [act@latest](https://www.nixhub.io/packages/act)
* [jq@latest](https://www.nixhub.io/packages/jq)

## Script Details

### devbox run build
```sh
nix build
```
&ensp;

### devbox run load
```sh
nix build .#loadImage && ./result/bin/load-image
```
&ensp;

### devbox run push
```sh
nix build .#pushToGhcr && GITHUB_USERNAME=$GITHUB_USERNAME GITHUB_TOKEN=$GITHUB_TOKEN ./result/bin/push-to-ghcr
```
&ensp;



<!-- gen-readme end -->
